"use strict";

var mongo    = require('mongodb');
var mongolia = require('mongolia');

var Server   = mongo.Server;
var Db       = mongo.Db;

/**
 * initialize the connections
 */
var config   = require('ee_config');
var dsConfig = config.loadConfig('persist');

/**
 * create the conneciton
 */
//db = new Db('blog', new Server('localhost', 27017, {auto_reconnect: true, native_parser: true}));

exports.DS = {
  getDS:function(schemaname){
    var schema = dsConfig[schemaname];
    if(schema){
      var host = schema.host;
      var port = schema.port;
      var svrsetting = {
        auto_reconnect : true,
        native_parser  : true
      };
      var server = new Server(host, port, svrsetting);
      var db = new Db(schemaname, server);
      return db;

    } else {
      throw 'schema ' + schemaname + ' not found';
    }
  }
};
